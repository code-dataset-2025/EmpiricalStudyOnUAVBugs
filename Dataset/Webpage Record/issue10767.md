# Basic Information:
### Title:  exchanged column for roll and yaw in px_generate_mixers.py #10767 
### Issue status: Closed
### Author: leonhartyao
### Issue open time: Oct 26, 2018
# Report
### Report author: leonhartyao
### Report Time: Oct 26, 2018
### Report Content:   
Describe the bug    
in some mixer table (mixer_multirotor_*.h), which are generated by px_generate_mixers.py, the yaw column and roll column are exchanged. Supposed order should be roll pitch yaw throttle and varified for hexarotors. However the order for quadrotor x and y is yaw pitch roll throttle.  
To Reproduce    
Steps to reproduce the behavior:  
1.change the toml file, e.g. chang Cm of some motors to 10 times, which should only affects yaw motion.  
2.build  
3.Only the first conlumn changes in the mixer_multirotor_*.h files  
Only 4x and 4y are checked.  

# Comment
## Comment1
### Comment author: dagar
### Comment Time: Oct 26, 2018
### Comment Content:   
For reference here's the original pull request that added the new mixer generation script. \\\#8063  

## Comment2
### Comment author: jlecoeur
### Comment Time: Oct 26, 2018
### Comment Content:   
This is not a bug. The column order is not inverted, and what you observe is the expected behaviour.  
I think that you confuse effectiveness matrix and the mixer matrix. Let me use your example. Let's look at the generated matrices for quad_x:  
    
```bash     
 $ python src/lib/mixer/geometries/tools/px_generate_mixers.py -f src/lib/mixer/geometries/quad_x.toml --verbose    
```  
the output contains:  
    
```bash     
 A:        
[[-0.71  0.71  0.71 -0.71]        
 [ 0.71 -0.71  0.71 -0.71]        
 [ 0.05  0.05 -0.05 -0.05]        
 [ 0.    0.    0.    0.  ]        
 [ 0.    0.    0.    0.  ]        
 [-1.   -1.   -1.   -1.  ]]        
B:        
(...)        
Normalized Mix (as in PX4):        
[[-0.71  0.71  1.    0.    0.   -1.  ]        
 [ 0.71 -0.71  1.    0.    0.   -1.  ]        
 [ 0.71  0.71 -1.    0.    0.   -1.  ]        
 [-0.71 -0.71 -1.    0.    0.   -1.  ]]        
```  
where A is the effectiveness matrix (i.e. each column indicates the effectiveness of one rotor on roll, pitch, yaw, x_thrust,  y_thrust and z_thrust), and B is the mixer matrix (i.e. each line contains the command to send to one motor for roll, pitch, yaw, x_thrust, y_thrust and z_thrust).  
Now if we modify the mixer and multiply by 10 the moment coefficient of the first motor by adding Cm = 0.5 on line 17 of the file quad_x.toml:  
    
```bash     
 python src/lib/mixer/geometries/tools/px_generate_mixers.py -f src/lib/mixer/geometries/quad_assym_cm.toml --verbose    
```  
we obtain:  
    
```bash     
 A:        
[[-0.71  0.71  0.71 -0.71]        
 [ 0.71 -0.71  0.71 -0.71]        
 [ 0.5   0.05 -0.05 -0.05]        
 [ 0.    0.    0.    0.  ]        
 [ 0.    0.    0.    0.  ]        
 [-1.   -1.   -1.   -1.  ]]        
B:        
(...)        
Normalized Mix (as in PX4):        
[[-0.18  0.18  1.    0.    0.   -0.31]        
 [ 0.98 -0.98  1.    0.    0.   -0.31]        
 [ 0.18  0.98 -1.    0.    0.   -1.69]        
 [-0.98 -0.18 -1.    0.    0.   -1.69]]        
```  
You can see that  
- in the effectiveness matrix, the yaw element for the first rotor (element A[2,0]) has indeed increased because the first motor is now more effective at producing yaw  
- in the mixer matrix, the yaw column is unchanged because that would otherwise introduce coupling (all motors still have equal thrust coefficient).  
- the 4 rotors no longer have the same 0.71 weight in the mixer matrix for roll and pitch, this avoids roll-to-yaw and pitch-to-yaw coupling.  
